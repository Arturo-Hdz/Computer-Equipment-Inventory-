<ui:composition template="/WEB-INF/templates/layout.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
	<ui:define name="content">

		<input type="hidden" id="usuario" name="usuario"
			value="#{userManagedBean.usuario.id}" />

		<title>Mantenimiento | INVISIS</title>
		<center>

			<h:form id="form3">
					<p:megaMenu style="margin-top:20px">
					<p:menuitem value="Inicio" url="/views/home.jsf"
						icon="ui-icon-home" />

					<p:submenu label="Equipo" icon="ui-icon-document">
						<p:column>
							<p:submenu label="Equipo">
								<p:menuitem value="Equipo"
									actionListener="#{equipoBean.llenaEquipo}"
									update=":tabla:tablaequi" ajax="false" />
							</p:submenu>
							<p:submenu label="Reporte Equipo Activados">
								<p:menuitem value="Reporte General"
									actionListener="#{equipoBean.llenaEquipo3}"
									update=":tabla:tablaequi" ajax="false" />
								<p:menuitem value="Reporte Individual"
									actionListener="#{equipoBean.llenaEquipo1}"
									update=":tabla:tablaequi" ajax="false" />
								<p:menuitem value="Reporte Filtrado"
									actionListener="#{equipoBean.llenaEquipo2}"
									update=":tabla:tablaequi" ajax="false" />
							</p:submenu>
							<p:submenu label="Reporte Equipo Desactivados">
								<p:menuitem value="Reporte General"
									actionListener="#{equipoBean.llenaEquipo4}"
									update=":tabla:tablaequi" ajax="false" />
								<p:menuitem value="Reporte Individual"
									actionListener="#{equipoBean.llenaEquipo5}"
									update=":tabla:tablaequi" ajax="false" />
								<p:menuitem value="Reporte Filtrado"
									actionListener="#{equipoBean.llenaEquipo6}"
									update=":tabla:tablaequi" ajax="false" />
							</p:submenu>

						</p:column>
					</p:submenu>

					<p:submenu label="Traspasos" icon="ui-icon-document">
						<p:column>
							<p:submenu label="Traspasos">
								<p:menuitem value="Movimientos Equipos"
									actionListener="#{equipoBean.llenaEquipo7}"
									update=":tabla:tablaequipos" ajax="false" />
								<p:menuitem value="Historial de Movimientos"
									actionListener="#{movimientosBean.llenaMovimientos}"
									update=":tabla:tablamov" ajax="false" />
							</p:submenu>
						</p:column>
					</p:submenu>

					<p:submenu label="Mantenimiento" icon="ui-icon-document">
						<p:column>
							<p:submenu label="Equipo Mantenimiento">
								<p:menuitem value="Mantenimiento"
									actionListener="#{paqueteriaBean.llenaTm}"
									update=":tabla:tablatm" ajax="false" />
							</p:submenu>

							<p:submenu label="Reporte Equipo Mantenimiento Activados">
								<p:menuitem value="Reporte General"
									actionListener="#{paqueteriaBean.llenaTm3}"
									update=":tabla:tablatm" ajax="false" />
								<p:menuitem value="Reporte Individual"
									actionListener="#{paqueteriaBean.llenaTm1}"
									update=":tabla:tablatm" ajax="false" />
								<p:menuitem value="Reporte Filtrado"
									actionListener="#{paqueteriaBean.llenaTm2}"
									update=":tabla:tablatm" ajax="false" />
							</p:submenu>
							<p:submenu label="Reporte Equipo Mantenimiento Desactivados">
								<p:menuitem value="Reporte General"
									actionListener="#{paqueteriaBean.llenaTm6}"
									update=":tabla:tablatm" ajax="false" />
								<p:menuitem value="Reporte Individual"
									actionListener="#{paqueteriaBean.llenaTm4}"
									update=":tabla:tablatm" ajax="false" />
								<p:menuitem value="Reporte Filtrado"
									actionListener="#{paqueteriaBean.llenaTm5}"
									update=":tabla:tablatm" ajax="false" />
							</p:submenu>

						</p:column>
					</p:submenu>

					<p:submenu label="Clasificación" icon="ui-icon-document">
						<p:column>
							<p:submenu label="Clasificación">
								<p:menuitem value="Monitor"
									actionListener="#{mouseBean.llenaMon}" update=":tabla:tablamon"
									ajax="false" />
								<p:menuitem value="Mouse"
									actionListener="#{mouseBean.llenaMouse}"
									update=":tabla:tablamou" ajax="false" />
								<p:menuitem value="Teclado"
									actionListener="#{impresoraBean.llenaTecla}"
									update=":tabla:tablatecla" ajax="false" />
								<p:menuitem value="No break"
									actionListener="#{escanerBean.llenaNob}"
									update=":tabla:tablanob" ajax="false" />
								<p:menuitem value="Escáner"
									actionListener="#{escanerBean.llenaEsca}"
									update=":tabla:tablaesca" ajax="false" />
								<p:menuitem value="Impresora"
									actionListener="#{impresoraBean.llenaImpre}"
									update=":tabla:tablaimpre" ajax="false" />
							</p:submenu>
						</p:column>
					</p:submenu>

					<p:submenu label="Catálogos" icon="ui-icon-pencil">
						<p:column>
							<p:submenu label="Marca">
								<p:menuitem value="Fabricante"
									actionListener="#{userManagedBean.llenafabricante}"
									update=":tabla:tablafabricantes" ajax="false" />
								<p:menuitem value="Sistema Operativo"
									actionListener="#{soBean.llenaSo}" update=":tabla:tablaso"
									ajax="false" />
								<p:menuitem value="Paquetería"
									actionListener="#{paqueteriaBean.llenaPq}"
									update=":tabla:tablapaq" ajax="false" />
							</p:submenu>
							<p:submenu label="Areas">
								<p:menuitem value="Área"
									actionListener="#{movimientosBean.llenaArea}"
									update=":tabla:tablaareas" ajax="false" />
								<p:menuitem value="Departamento"
									actionListener="#{movimientosBean.llenaDepa}"
									update=":tabla:tabladepas" ajax="false" />
							</p:submenu>

							<p:submenu label="Usuarios">
								<p:menuitem value="Personal"
									actionListener="#{personalBean.llenaPersonal}"
									update=":tabla:tablaperson" ajax="false" />
								<p:menuitem value="Usuarios"
									actionListener="#{userManagedBean.llenausuario}"
									update=":tabla:tablausuarios" ajax="false" />
							</p:submenu>
						</p:column>
					</p:submenu>
					<p:menuitem value="Logout" url="/default.jsf"
						icon="ui-icon-close" />

				</p:megaMenu>
			</h:form>

			<p:panel id="panel" header="Bienvenido #{userManagedBean.username}!"
				heigth="100%">
				<BR></BR>

				<p:dialog header="Nuevo Mantenimiento" widgetVar="dlg"
					resizable="false">
					<h:form id="form2">

						<p:messages id="msgs" showDetail="false" />

						<h:panelGrid id="panel" header="Nuevo Mantenimiento" columns="2"
							style="margin-bottom:10px">

							<h:outputLabel for="equipo" value="Equipo:" style="float:right;" />
							<p:selectOneMenu id="equipo" value="#{paqueteriaBean.nuevoeq}"
								required="true" requiredMessage="Seleccione el equipo"
								filter="true" filterMatchMode="startsWith" style="width:170px">
								<f:selectItem itemLabel="Seleccione" itemValue="0" />
								<f:selectItems value="#{paqueteriaBean.equipos2}" var="equi"
									itemLabel="#{equi.no_serie}" itemValue="#{equi.id_equipo}" />
							</p:selectOneMenu>

							<p:outputLabel for="fecha1" value="Fecha Inicial:"
								style="float:right;" />
							<p:calendar id="fecha1" value="#{paqueteriaBean.fecha1}"
								actionListener="#{paqueteriaBean.click}"
								pattern="dd-MM-yyyy HH:mm:ss a" mask="true" />

							<p:outputLabel for="fecha2" value="Fecha Entrega:"
								style="float:right;" />
							<p:calendar id="fecha2" value="#{paqueteriaBean.fecha2}"
								actionListener="#{paqueteriaBean.click}"
								pattern="dd-MM-yyyy HH:mm:ss a" mask="true" />

							<p:outputLabel for="tm" value="Tipo de Mantenimiento:" />
							<p:selectOneRadio id="tm"
								value="#{paqueteriaBean.tipo_mantenimiento}">
								<f:selectItem itemLabel="Preventivo" itemValue="Preventivo" />
								<f:selectItem itemLabel="Correctivo" itemValue="Correctivo" />
								<f:selectItem itemLabel="Ambos" itemValue="Ambos" />
							</p:selectOneRadio>

							<h:outputLabel value="Descripción:" style="float:right;" />
							<p:inputTextarea id="desc" value="#{paqueteriaBean.observacion}"
								rows="5" cols="20" counter="display" maxlength="250"
								counterTemplate=" {0} caractéres quedan" autoResize="false">
							</p:inputTextarea>
							<h:outputLabel />
							<h:outputLabel id="display" style="float:left;" />

						</h:panelGrid>

						<p:commandButton id="btn" value="Añadir" update=":form2:msgs"
							action="#{paqueteriaBean.altaTipoMantenimiento()}" />
						<p:commandButton value="Cancelar" update="panel" process="@this"
							actionListener="#{paqueteriaBean.resetTm}"
							oncomplete="PF('dlg').hide();" />

					</h:form>
				</p:dialog>

				<h:form id="form">

					<p:growl id="messages" showDetail="true" />


					<p:commandButton id="showDialogButton" type="button"
						value="Registrar Nuevo Mantenimiento" onclick="PF('dlg').show()" />

					<p:commandButton id="btn" value="Actualizar"
						update=":tabla:tablatm" ajax="false"
						action="#{paqueteriaBean.llenaTm}" />

					<p:contextMenu for="tablatm">
						<p:menuitem value="Borrar Mantenimiento" update="tablatm"
							icon="ui-icon-close"
							actionListener="#{paqueteriaBean.borrarTm()}" />
						<p:menuitem value="Oculta Menú" icon="ui-icon-extlink"
							onclick="PF('cMenu').hide()" />
					</p:contextMenu>

					<p:dataTable id="tablatm" var="tm"
						value="#{paqueteriaBean.listaTm}" editable="true" editMode="cell"
						widgetVar="Tabletm" selectionMode="single"
						rowKey="#{tm.id_tipo_mantenimiento}"
						selection="#{paqueteriaBean.selectedTm}"
						paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} 
						{PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
						paginator="true" rows="20" style="margin-bottom:20px">

						<f:facet name="{Exporters}">
							<h:commandLink ajax="false">
								<p:graphicImage value="/images/pdf.png" width="30"
									style="float:right;width:30px;height:29px" />
								<p:dataExporter type="pdf" target="tablatm"
									fileName="#{paqueteriaBean.fileName}" pageOnly="false"
									selectionOnly="false"
									preProcessor="#{paqueteriaBean.preProcessPDF}"
									postProcessor="#{paqueteriaBean.postProcessPDF}" />
							</h:commandLink>

							<h:commandLink ajax="false">
								<p:graphicImage value="/images/excel.jpg" width="30"
									style="float:right;width:30px;height:29px" />
								<p:dataExporter type="xls" target="tablatm"
									fileName="#{paqueteriaBean.fileName}" pageOnly="false"
									selectionOnly="false"
									postProcessor="#{paqueteriaBean.postProcessXLS}" />
							</h:commandLink>

						</f:facet>

						<f:facet name="header">Reporte de Mantenimiento</f:facet>

						<p:ajax event="cellEdit" listener="#{paqueteriaBean.onCellEditTm}"
							update=":form:messages" />

						<p:column headerText="Id" style="width:25%">
							<f:facet name="header" id="id">Id</f:facet>
							<h:outputText value="#{tm.id_tipo_mantenimiento}" />
						</p:column>

						<p:column headerText="No. Serie (Equipo)" style="width:25%"
							filterBy="#{tm.equipo.no_serie}" footerText="No. Serie"
							filterMatchMode="contains">
							<f:facet name="header" id="id4">Equipo</f:facet>
							<h:outputText value="#{tm.equipo.no_serie}">
							</h:outputText>
						</p:column>

						<p:column headerText="Fecha Inicial" style="width:25%">
							<f:facet name="header" id="id2">Fecha Inicial</f:facet>
							<h:outputText value="#{tm.fecha}">
								<f:convertDateTime pattern="yyyy-MMM-d a" />
							</h:outputText>
						</p:column>

						<p:column headerText="Fecha Entrega" style="width:25%">
							<f:facet name="header" id="id3">Fecha Entrega</f:facet>
							<h:outputText value="#{tm.fecha2}">
								<f:convertDateTime pattern="yyyy-MMM-d a" />
							</h:outputText>
						</p:column>

					<!-- 	<p:column headerText="Area" style="width:25%">
							<f:facet name="header" id="id5">Area</f:facet>
							<h:outputText value="#{tm.equipo.area.nombre_area}" />
						</p:column>

						<p:column headerText="Departamento" style="width:25%">
							<f:facet name="header" id="id6">Departamento</f:facet>
							<h:outputText
								value="#{tm.equipo.departamento.nombre_departamento}" />
						</p:column>

						<p:column headerText="Personal" style="width:25%">
							<f:facet name="header" id="id7">Personal</f:facet>
							<h:outputText value="#{tm.equipo.personal.nombre}" />
						</p:column>
						 -->

						<p:column headerText="Tipo de Mantenimiento" style="width:25%">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{tm.tipo_mantenimiento}" />
								</f:facet>
								<f:facet name="input">
									<h:selectOneMenu id="tipoman"
										value="#{paqueteriaBean.tipo_mantenimiento}" required="true"
										requiredMessage="Seleccione el tipo de mantenimiento">
										<f:selectItem itemLabel="Seleccione" itemValue="0" />
										<f:selectItem itemLabel="Preventivo" itemValue="Preventivo" />
										<f:selectItem itemLabel="Correctivo" itemValue="Correctivo" />
										<f:selectItem itemLabel="Ambos" itemValue="Ambos" />
									</h:selectOneMenu>
								</f:facet>
							</p:cellEditor>
						</p:column>

						<p:column headerText="Descripcion" style="width:25%">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{tm.observacion}" />
								</f:facet>
								<f:facet name="input">
									<p:inputText value="#{tm.observacion}" style="width:96%"
										label="descripcion" />
								</f:facet>
							</p:cellEditor>
						</p:column>

						<p:column headerText="Reparación" style="width:25%">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{tm.reparacion}" />
								</f:facet>
								<f:facet name="input">
									<p:selectOneMenu id="reparacion"
										value="#{paqueteriaBean.reparacion}" required="true"
										style="width:96%"
										requiredMessage="Seleccione si el mantenimiento del equipo esta terminado">
										<f:selectItem
											itemLabel="Seleccione si el mantenimiento del equipo esta terminado"
											itemValue="0" />
										<f:selectItem itemLabel="Terminado" itemValue="Terminado" />
									</p:selectOneMenu>
								</f:facet>
							</p:cellEditor>
						</p:column>

						<p:column headerText="Estatus" style="width:25%">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="Activo" />
								</f:facet>
								<f:facet name="input">
									<p:selectOneMenu id="estatus" value="#{paqueteriaBean.estatus}"
										required="true" style="width:96%"
										requiredMessage="Seleccione si desea desactivar">
										<f:selectItem itemLabel="Seleccione si desea Desactivar" />
										<f:selectItem itemLabel="Desactivar" itemValue="0" />
									</p:selectOneMenu>
								</f:facet>
							</p:cellEditor>
						</p:column>

					</p:dataTable>
				</h:form>
			</p:panel>
		</center>

	</ui:define>
</ui:composition>